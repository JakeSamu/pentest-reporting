import os


def latex_integrity_check():
    dir_to_check = os.path.join("usersection","management")
    files_to_check = os.listdir(dir_to_check)

    command_list_file = open(os.path.join("automation","latex_conversion","integrity_checker","commandlist.lst"), "r", encoding="utf-8")
    command_list = []
    for line in command_list_file.read().split("\n"):
        command_list.append("\\"+line)
    command_list_file.close()

    for file_tocheck in files_to_check:
        if file_tocheck.endswith(".tex"):
            file = open(os.path.join(dir_to_check,file_tocheck), "r", encoding="utf-8")
            original_content = file.read()
            file.close()
            
            new_content = original_content
            for command in command_list:
                new_content = new_content.replace(" "+command+" ", " {"+command+"} ")
                new_content = new_content.replace(" "+command+".", " {"+command+"}.")
                new_content = new_content.replace(" "+command+",", " {"+command+"},")
                new_content = new_content.replace(" "+command+"~", " {"+command+"} ")

            if new_content != original_content:
                file = open(os.path.join(dir_to_check,file_tocheck), "w", encoding="utf-8")
                file.write(new_content)
                file.close()

if __name__ == "__main__":
    latex_integrity_check()