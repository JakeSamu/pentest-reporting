import os
from datetime import datetime

def delete_in_folder(path_to_folder):
    for direlement in os.listdir(path_to_folder):
        if direlement != "images":
            os.remove(os.path.join(path_to_folder, direlement))
    for direlement in os.listdir(os.path.join(path_to_folder,"images")):
        if direlement != "images":
            os.remove(os.path.join(path_to_folder, "images", direlement))

def delete_content_of_file(filename_with_path):
    f = open(filename_with_path, "w")
    f.close()


def delete_appendix():
    print("\n### Deleting appendix")
    appendix_path = os.path.join("usersection","appendix")
    delete_in_folder(appendix_path)

def delete_findings():
    print("\n### Deleting findings")
    findings_path = os.path.join("usersection","findings")
    delete_in_folder(findings_path)

def reset_history():
    print("\n### Resetting history")
    history_file = os.path.join("usersection", "variables", "history.json")
    file_writer = open(history_file, "w")
    date = datetime.today().strftime("%d.%m.%Y")
    file_writer.write(f"""{{
    "0.1" : {{
        "date": "{date}",
        "reason": "Projektstart"
    }}
}}
""")
    file_writer.close()

def reset_management_content():
    print("\n### cleaning up content of management files")
    management_path = os.path.join("usersection", "management")
    for direlement in os.listdir(management_path):
        delete_content_of_file(os.path.join(management_path, direlement))


def restart():
    res = str(input("Are you sure you want to delete appendix, findings and history? y/N\n"))
    if res.lower() == "y":
        print("\n### Restarting project")
        delete_appendix()
        delete_findings()
        reset_history()
        reset_management_content()
    elif res.lower() != "n" and res != "":
        print("Please only write y/Y or n/N.")
        restart()

if __name__ == "__main__":
    restart()